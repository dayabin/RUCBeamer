%Note that this ruc template was developed upon Dr. Miller's work. You can find his original template from the link below.
%http://svmiller.com/blog/2019/08/r-markdown-template-beamer-presentations/

%%%%%%
%Remember to change the titlegraphic path to the path on your local machine.
%To do this, search for "\titlegraphic" and replace the relevant path.
%%%%%%

\documentclass[10pt,ignorenonframetext,,aspectratio=149]{beamer}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\usepackage{lmodern}
\usepackage{mathtools}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
% 
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}

\title{RUCBeamer}
\author{Yabin Da}
\date{2023-04-23}

%% Add any required packages here.
%%--------------------------

\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{wasysym}
\usepackage{booktabs}
\usepackage{ThreePartTable}


% Get rid of navigation symbols.
%-------------------------------
\setbeamertemplate{navigation symbols}{}

% Optional institute tags and titlegraphic.
% Do feel free to change the titlegraphic if you don't want it as a Markdown field.
%----------------------------------------------------------------------------------
\institute{\normalsize School of Agricultural Economics and Rural
Development}


% Somehow, the if sentence below did not work for me. I, therefore, placed the absolute path below and it worked. 
\titlegraphic{\includegraphics[width=0.2\paperwidth]{C:/work/RUCBeamer/RUCBeamer/ruc/Renmin-University-of-China-logo_3.png}} 
% -----------------------------------------------------------------------------------------------------
%

% Some additional title page adjustments.
%----------------------------------------
\setbeamertemplate{title page}[empty]
%\date{}
\setbeamerfont{subtitle}{size=\normal}

\setbeamercovered{transparent}

% Some optional colors. Change or add as you see fit.
%---------------------------------------------------
\definecolor{rucmaroon}{HTML}{AE0B2A}
\definecolor{rucwhite}{HTML}{FFFFFF}


% Some optional color adjustments to Beamer. Change as you see fit.
%------------------------------------------------------------------
\setbeamercolor{frametitle}{fg=rucwhite,bg=rucmaroon}
\setbeamercolor{title}{fg=rucwhite,bg=rucmaroon}
\setbeamercolor{local structure}{fg=rucmaroon}
\setbeamercolor{section in toc}{fg=rucwhite,bg=rucmaroon}
\setbeamercolor{subsection in toc}{fg=rucwhite,bg=rucmaroon}
\setbeamercolor{footline}{fg=rucmaroon, bg=rucwhite}
\setbeamercolor{block title}{fg=rucwhite, bg=rucmaroon}


\let\Tiny=\tiny


% Sections and subsections should not get their own damn slide.
%--------------------------------------------------------------
\AtBeginPart{}
\AtBeginSection{}
\AtBeginSubsection{}
\AtBeginSubsubsection{}

% Suppress some of Markdown's weird default vertical spacing.
%------------------------------------------------------------
\setlength{\emergencystretch}{0em}  % prevent overfull lines
\setlength{\parskip}{0pt}


% Allow for those simple two-tone footlines I like. 
% Edit the colors as you see fit.
%--------------------------------------------------
\defbeamertemplate*{footline}{my footline}{%
    \ifnum\insertpagenumber=1
    \hbox{%
        \begin{beamercolorbox}[wd=\paperwidth,ht=.8ex,dp=1ex,center]{}%
      % empty environment to raise height
        \end{beamercolorbox}%
    }%
    \vskip0pt%
    \else%
        \Tiny{%
            \hfill%
		\vspace*{1pt}%
            \insertframenumber/\inserttotalframenumber \hspace*{0.1cm}%
            \newline%
            \color{rucmaroon}{\rule{\paperwidth}{0.4mm}}\newline%
            \color{rucmaroon}{\rule{\paperwidth}{.4mm}}%
        }%
    \fi%
}

% Various cosmetic things, though I must confess I forget what exactly these do and why I included them.
%-------------------------------------------------------------------------------------------------------
\setbeamercolor{structure}{fg=blue}
\setbeamercolor{local structure}{parent=structure}
\setbeamercolor{item projected}{parent=item,use=item,fg=rucmaroon,bg=white}
\setbeamercolor{enumerate item}{parent=item}

% Adjust some item elements. More cosmetic things.
%-------------------------------------------------
\setbeamertemplate{itemize item}{\color{rucmaroon}$\bullet$}
\setbeamertemplate{itemize subitem}{\color{rucmaroon}\scriptsize{$\bullet$}}
\setbeamertemplate{itemize/enumerate body end}{\vspace{.6\baselineskip}} % So I'm less inclined to use \medskip and \bigskip in Markdown.

% Automatically center images
% ---------------------------
% Note: this is for ![](image.png) images
% Use "fig.align = "center" for R chunks

% \usepackage{etoolbox}
% 
% \AtBeginDocument{%
%   \letcs\oig{@orig\string\includegraphics}%
%   \renewcommand<>\includegraphics[2][]{%
%     \only#3{%
%       {\centering\oig[{#1}]{#2}\par}%
%     }%
%   }%
% }

% I think I've moved to xelatex now. Here's some stuff for that.
% --------------------------------------------------------------
% I could customize/generalize this more but the truth is it works for my circumstances.

\ifxetex
\setbeamerfont{title}{family=\fontspec{serif}}
\setbeamerfont{frametitle}{family=\fontspec{serif}}
\usepackage[font=small,skip=0pt]{caption}
 \else
 \fi

% Okay, and begin the actual document...

\begin{document}
\frame{\titlepage}

\begin{frame}
\end{frame}


%Comment this off if you need a table of content slide. 
% \section[]{}
% \frame{\small \frametitle{Table of Contents}
% \tableofcontents}

%The Thank you slide
\begin{frame}
\begin{center}
\textcolor{rucmaroon}{\Huge Thank You!}
\end{center}
\end{frame}


\end{document}